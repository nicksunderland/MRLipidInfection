[{"path":"https://nicksunderland.github.io/MRLipidInfection/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 MRLipidInfection authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"can install latest version MRLipidInfection R using:","code":"remotes::install_github(\"nicksunderland/MRLipidInfection\")"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"First need load MRLipidInfection package setup package requirements calling setupMRLipidInfection(). first installation take time download 1000 genomes LD reference panel package file structure ensure PLINK installed locally.","code":"library(MRLipidInfection)  setupMRLipidInfection()"},{"path":[]},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"lipid-profile-data","dir":"Articles","previous_headings":"Exposure data","what":"Lipid profile data","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"Next must obtain data exposure. interested whether exposure lipid lowering medications influences risk developing sepsis. data readily available population level many confounding factors. therefore estimate effect genetically proxied lipid medication therapy looking Single Nucleotide Polymorphisms (SNPs) close proximity known lipid metabolism genes (e.g. HMG-CoA reductase) significantly associated circulating lipid levels. use latest Global Lipids Genetics Consortium Ancestry-specific GWAS summary statistics HDL-C, LDL-C, nonHDL-C, TC TG. First download data LDL cholesterol - Warning GWAS data file large take time download. 47 million SNPs dataset. now filter GWAS data SNPs associated circulating LDL cholesterol levels statisticsal significance p<5e-8. Reading file can take long time can write result .csv file. inspect column names see need adjustment ensure compatible TwoSampleMR package naming conventions.","code":"# The URL for the GWAS summary statistics README document url_rm <- \"http://csg.sph.umich.edu/willer/public/glgc-lipids2021/results/ancestry_specific/README.txt\"  # Download README to the package downloads directory (subdirectory \"glgc\"). get_web_file(url_rm, directory=\"glgc\")  # The URLs for the GWAS summary statistics data lipids_gwas_urls <- list(   ldl    = \"http://csg.sph.umich.edu/willer/public/glgc-lipids2021/results/ancestry_specific/LDL_INV_EUR_HRC_1KGP3_others_ALL.meta.singlevar.results.gz\",   hdl    = \"http://csg.sph.umich.edu/willer/public/glgc-lipids2021/results/ancestry_specific/HDL_INV_EUR_HRC_1KGP3_others_ALL.meta.singlevar.results.gz\",   tc     = \"http://csg.sph.umich.edu/willer/public/glgc-lipids2021/results/ancestry_specific/TC_INV_EUR_HRC_1KGP3_others_ALL.meta.singlevar.results.gz\",   nonhdl = \"http://csg.sph.umich.edu/willer/public/glgc-lipids2021/results/ancestry_specific/nonHDL_INV_EUR_HRC_1KGP3_others_ALL.meta.singlevar.results.gz\",   tg     = \"http://csg.sph.umich.edu/willer/public/glgc-lipids2021/results/ancestry_specific/logTG_INV_EUR_HRC_1KGP3_others_ALL.meta.singlevar.results.gz\")  # Download GLGC GWAS data to package downloads directory; return the file paths lipids_gwas_fps <- lapply(lipids_gwas_urls, get_web_file, directory=\"glgc\") lipids_gwas_fps # set significance level for filtering SNPs  p <- 5e-8  # Read the .gz data files and filter by significance level sig_snps <- purrr::map2(.x = lipids_gwas_fps,                                            .y = names(lipids_gwas_fps),                                    .f = ~extract_significant_snps(.x, .y, pval=p, pval_col=\"pvalue\", snp_col=\"rsID\"))  # Add the name  sig_snps <- purrr::map2(.x = sig_snps,                          .y = names(sig_snps),                         .f = ~ .x |> dplyr::mutate(phenotype = .y))  # View one of the tables: utils::head(sig_snps$ldl)  # The file path to the data in .csv format attr(sig_snps$ldl, \"filepath\") # The current column names colnames(sig_snps$ldl)  # Standardise exposure data column names exposure_data <- purrr::map(.x = sig_snps,                             .f = ~ TwoSampleMR::format_data(                                     dat               = .x,                                     type              = \"exposure\",                                     phenotype_col     = \"phenotype\",                                     snp_col           = \"rsID\",                                     beta_col          = \"EFFECT_SIZE\",                                     se_col            = \"SE\",                                     eaf_col           = \"POOLED_ALT_AF\",                                     effect_allele_col = \"ALT\",                                     other_allele_col  = \"REF\",                                     pval_col          = \"pvalue\",                                     samplesize_col    = \"N\",                                     chr_col           = \"CHROM\",                                     pos_col           = \"POS_b37\"))"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"cis-acting-hmg-coa-reductase-snps","dir":"Articles","previous_headings":"Exposure data","what":"Cis-acting HMG-CoA Reductase SNPs","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"create second set exposure SNPs subset SNPs associate LDL cholesterol levels. subset SNPs within certain proximity (number bases) HMG-CoA Reductase gene. Data regarding position HMG-CoA-R gene freely available online. Lipid data GLGC uses Genome Reference Consortium Human Reference 37 (GRCh37) must use referring position HMG-CoA-R gene.","code":"# The HMG-CoA-R gene is on chromosome 5, starts at base 746,32,993 and ends at base 74,657,941. chrom_hmg <- 5 start_hmg <- 74632993 end_hmg   <- 74657941  # We want to capture SNPs near the HMG-CoA gene and so we must set a tolerance window either side in # which to also search ## changed for testing, normal 3e5 tol <- 3e6  # Create a new dataset of SNPs close to the HMG-CoA gene cis_exp_dat <- purrr::map(   .x = exposure_data,   .f = ~ .x |>     dplyr::mutate(id.exposure = dplyr::if_else(.data$chr.exposure == chrom_hmg &                                                .data$pos.exposure > (start_hmg - tol) &                                                .data$pos.exposure < (end_hmg   + tol),                                                 \"cis_hmg\", NA_character_)) |>     dplyr::filter(!is.na(id.exposure))   )"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"clumping-snps","dir":"Articles","previous_headings":"Exposure data","what":"Clumping SNPs","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"Many SNPs highly correlated, .e. genetically linked provide additional information whole set correlated SNPs. reduce number SNPs significantly associated lipid levels use Linkage Disequilibrium clumping. Clumping reports significant genetic associations region terms smaller number “clumps” genetically linked SNPs. SNPs correlated R2 greater value clump_r2 clumped - .e. SNP lower p-value removed. process iterative several parameters: clump_kb, clump_r2, clump_p. use defaults, except clump_r2 cis-HMG-CoA-R SNPs, set 0.1 instead default 0.001. Bristol IEU severs using function TwoSampleMR::clump_data. Alternatively, can locally using 1000 Genomes Reference Panel PLINK binary downloaded earlier.","code":"# Only significant SNPs in close proximity to the HMG-CoA reductase gene #TODO: write function to deal with no results from clumping (at the minute the cis window is big) clump_r2 <- 0.1 clumped_exp_dat <- purrr::map(.x = unname(cis_exp_dat),                                .f = ~ TwoSampleMR::clump_data(                                 dat      = .x,                                 clump_r2 = clump_r2)) names(clumped_exp_dat) <- names(cis_exp_dat) clump_r2 <- 0.1 clumped_exp_dat <- purrr::map(.x = unname(cis_exp_dat),                               .f = ~ ieugwasr::ld_clump(                                 dat       = dplyr::tibble(rsid=.x$SNP,                                                           pval=.x$pval.exposure),                                 plink_bin = genetics.binaRies::get_plink_binary(),                                 bfile     = get_b_file(),                                  clump_r2  = clump_r2)) names(clumped_exp_dat) <- names(cis_exp_dat)"},{"path":[]},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"sepsis","dir":"Articles","previous_headings":"Outcome data","what":"Sepsis","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"outcome interested sepsis. several GWAS relating whether patient develops sepsis underlying SNPs. Several studies available IEU GWAS database can queried using either TwoSampleMR ieugwasr R packages.","code":"# List of available GWAS summary statistics available_gwas <- ieugwasr::gwasinfo() |>      # Filter for those that mention 'sepsis' in the 'trait' description column   dplyr::filter(grepl(\"sepsis|pneumonia\", .data$trait, ignore.case=TRUE))  # We will pick one outcome_gwas_id <- \"ieu-b-4980\"  # View available_gwas[available_gwas$id == outcome_gwas_id, ]"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"extracting-outcome-data","dir":"Articles","previous_headings":"Outcome data","what":"Extracting outcome data","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"identified GWAS summary statistics next need extract data SNPs interest (highly predictive exposure, case LDL cholesterol).","code":"# The cisHMG-CoA SNPs won't necessarily all be within the group of SNPs for the whole genome. ##all(clumped_hmg_exp$SNP %in% clumped_exp$SNP)  # Extract data for cis-HMG-CoA SNPs outcome_data <- purrr::map(.x = clumped_exp_dat,                            .f = ~ TwoSampleMR::extract_outcome_data(                               snps            = .x$SNP,                               outcomes        = outcome_gwas_id,                               proxies         = TRUE,                               rsq             = 0.8,                               align_alleles   = 1,                               palindromes     = 1,                               maf_threshold   = 0.3,                               access_token    = ieugwasr::check_access_token(),                               splitsize       = 10000,                               proxy_splitsize = 500)) names(outcome_data) <- names(clumped_exp_dat)"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"obtaining-outcome-data-not-on-the-ieu-gwas-database","dir":"Articles","previous_headings":"Outcome data","what":"Obtaining outcome data not on the IEU GWAS database","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"extract outcome data sources find proxy SNPs","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"harmonising","dir":"Articles","previous_headings":"","what":"Harmonising","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"effects (significant) SNPs LDL levels effect SNPs outcome sepsis. However, important harmonise effects. means effect SNP exposure effect SNP outcome must correspond allele (.e. &Ts C&Gs wrong way round). Note IEU GWAS database contains data already harmonised. information harmonising.","code":"# Harmonise the data for the LDL SNPs across the whole genome harm_dat <- purrr::map2(.x = clumped_exp_dat,                         .y = outcome_data,                         .f = ~ TwoSampleMR::harmonise_data(.x, .y))"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"two-sample-mendelian-randomisation","dir":"Articles","previous_headings":"","what":"Two Sample Mendelian Randomisation","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"whole point assess weight influence SNPs outcome","code":"# The MR result using SNPs from across the genome res_dat <- purrr::map(.x = harm_dat,                        .f = ~ TwoSampleMR::mr(.x))"},{"path":"https://nicksunderland.github.io/MRLipidInfection/articles/lipid-therapy-sepsis-mr.html","id":"plotting-the-result","dir":"Articles","previous_headings":"Two Sample Mendelian Randomisation","what":"Plotting the result","title":"Genetically Proxied Lipid Therapy And Sepsis","text":"","code":"plots <- purrr::map2(.x = res_dat,                       .y = harm_dat,                      .f = ~ TwoSampleMR::mr_scatter_plot(.x, .y)) plots"},{"path":[]},{"path":"https://nicksunderland.github.io/MRLipidInfection/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Nicholas Sunderland. Author, maintainer.","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sunderland N (2022). MRLipidInfection: Things Run MR Study Lipid Drug Effects Sepsis. R package version 0.0.0.9000, https://nicksunderland.github.io/MRLipidInfection/.","code":"@Manual{,   title = {MRLipidInfection: Things To Run An MR Study Of Lipid Drug Effects On Sepsis},   author = {Nicholas Sunderland},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://nicksunderland.github.io/MRLipidInfection/}, }"},{"path":"https://nicksunderland.github.io/MRLipidInfection/index.html","id":"mrlipidinfection","dir":"","previous_headings":"","what":"MRLipidInfection","title":"Things To Run An MR Study Of Lipid Drug Effects On Sepsis","text":"package trying Mendelian Randomisation techniques.","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Things To Run An MR Study Of Lipid Drug Effects On Sepsis","text":"can install latest version MRLipidInfection R using:","code":"remotes::install_github(\"mrcieu/gwasvcf\")"},{"path":"https://nicksunderland.github.io/MRLipidInfection/index.html","id":"projects","dir":"","previous_headings":"","what":"Projects","title":"Things To Run An MR Study Of Lipid Drug Effects On Sepsis","text":"Please see “Articles” tab. https://nicksunderland.github.io/MRLipidInfection/","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/extract_significant_snps.html","id":null,"dir":"Reference","previous_headings":"","what":"extract_significant_snps — extract_significant_snps","title":"extract_significant_snps — extract_significant_snps","text":"extract_significant_snps","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/extract_significant_snps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"extract_significant_snps — extract_significant_snps","text":"","code":"extract_significant_snps(   filepath,   pval,   pval_col,   snp_col,   csv_out = NULL,   overwrite = FALSE )"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/extract_significant_snps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"extract_significant_snps — extract_significant_snps","text":"filepath file path extract pval p-value filter (values less kept) pval_col name column holding p-value snp_col name column holding snp id csv_out name label output .csv , default use filepath filename overwrite whether overwrite cache .csv file","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/extract_significant_snps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"extract_significant_snps — extract_significant_snps","text":"data table; attribute file path filtered .csv file","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_b_file.html","id":null,"dir":"Reference","previous_headings":"","what":"get_b_file() — get_b_file","title":"get_b_file() — get_b_file","text":"get_b_file()","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_b_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_b_file() — get_b_file","text":"","code":"get_b_file(ancestry = \"EUR\")"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_b_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_b_file() — get_b_file","text":"ancestry default European 'EUR'","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_b_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_b_file() — get_b_file","text":"file path ld reference panel 'B' files","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_downloads_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"get_downloads_dir() — get_downloads_dir","title":"get_downloads_dir() — get_downloads_dir","text":"get_downloads_dir()","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_downloads_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_downloads_dir() — get_downloads_dir","text":"","code":"get_downloads_dir(subdir = NA)"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_downloads_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_downloads_dir() — get_downloads_dir","text":"subdir provided return full file path subdirectory, within main downloads directory. exist, created.","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_downloads_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_downloads_dir() — get_downloads_dir","text":"absoltue file path downloads folder","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_finngen.html","id":null,"dir":"Reference","previous_headings":"","what":"get_finngen() — get_finngen","title":"get_finngen() — get_finngen","text":"Gets FinnGen data - downloads package downloads directory","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_finngen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_finngen() — get_finngen","text":"","code":"get_finngen(filename, type = \"summary_stats\", overwrite = FALSE)"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_finngen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_finngen() — get_finngen","text":"filename FinnGen file name, string type FinnGen data type overwrite whether overwrite file","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_finngen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_finngen() — get_finngen","text":"tibble containing data","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_proxy_snps.html","id":null,"dir":"Reference","previous_headings":"","what":"get_proxy_snps — get_proxy_snps","title":"get_proxy_snps — get_proxy_snps","text":"get_proxy_snps","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_proxy_snps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_proxy_snps — get_proxy_snps","text":"","code":"get_proxy_snps(snps, ancestry = \"EUR\", ...)"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_proxy_snps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_proxy_snps — get_proxy_snps","text":"snps character list vector SNPs ancestry ancestry use default \"EUR\" ... additional paramters pass gwasvcf::get_ld_proxies","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_proxy_snps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_proxy_snps — get_proxy_snps","text":"dataframe","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_web_file.html","id":null,"dir":"Reference","previous_headings":"","what":"get_web_file() — get_web_file","title":"get_web_file() — get_web_file","text":"Gets web based file downloads packages downloads directory (inst/extdata)","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_web_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_web_file() — get_web_file","text":"","code":"get_web_file(url, directory = NA, overwrite = FALSE)"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_web_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_web_file() — get_web_file","text":"url url file download, string directory either NA (download main downloads directory), full directory path (download ), string (used create subdirectory within main downloads directory) overwrite whether overwrite file","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/get_web_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_web_file() — get_web_file","text":"tibble containing data","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/setupMRLipidInfection.html","id":null,"dir":"Reference","previous_headings":"","what":"setupMRLipidInfection — setupMRLipidInfection","title":"setupMRLipidInfection — setupMRLipidInfection","text":"setupMRLipidInfection","code":""},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/setupMRLipidInfection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"setupMRLipidInfection — setupMRLipidInfection","text":"","code":"setupMRLipidInfection()"},{"path":"https://nicksunderland.github.io/MRLipidInfection/reference/setupMRLipidInfection.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"setupMRLipidInfection — setupMRLipidInfection","text":"side effect setup functions (see )","code":""}]
